<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Flavia de Jesus">
<meta name="description" content="No R, diversas classes de objetos, como dataframes, fatores e vetores, são essenciais para análise de dados. Explore os objetos da classe fator e descubra o pacote ideal para manipulá-los de maneira eficaz.">

<title>Como tratar a ordem dos fatores com forcats no R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<link href="../..//img/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner {
        background-image: url(banner.png);
background-size: cover;
      }
</style>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../img/daslab-logo-removebg.png" alt="" class="navbar-logo">
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Alternar de navegação" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../sobre/index.html"> 
<span class="menu-text">Sobre</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projetos/index.html"> 
<span class="menu-text">Projetos</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutoriais/index.html"> 
<span class="menu-text">Tutoriais</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../ensinar/index.html"> 
<span class="menu-text">ensinaR</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../oobr/index.html"> 
<span class="menu-text">OOBr</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../eventos/index.html"> 
<span class="menu-text">Eventos</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../contato/index.html"> 
<span class="menu-text">Contato</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Como tratar a ordem dos fatores com forcats no R</h1>
                  <div>
        <div class="description">
          No R, diversas classes de objetos, como dataframes, fatores e vetores, são essenciais para análise de dados. Explore os objetos da classe fator e descubra o pacote ideal para manipulá-los de maneira eficaz.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Data Wrangling</div>
                <div class="quarto-category">R</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Autor</div>
      <div class="quarto-title-meta-contents">
               <p>Flavia de Jesus </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Data de Publicação</div>
      <div class="quarto-title-meta-contents">
        <p class="date">15 de julho de 2021</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<style>
body {
    background: white;
}

.quarto-title-banner{
    text-align: left !important;
}
</style>
<section id="fatores-e-níveis" class="level3">
<h3 class="anchored" data-anchor-id="fatores-e-níveis"><code>Fatores e Níveis</code></h3>
<p>A linguagem R possui várias classes de objetos como dataframes, fatores, listas, matrizes, tibbles e vetores. E para nós que estudamos e usamos o R é indispensável saber para que cada objeto serve e como utilizar da melhor forma possível. Neste post vamos aprender um pouco sobre os fatores e sobre o pacote ideal para usar neste tipo de objeto. No R podemos definir fatores como um conjunto de categorias. Os valores que essas variáveis assumem são os níveis, ou simplesmente as categorias que compõem o fator. Os fatores são criados para representar variáveis categóricas.</p>
<p>Alguns exemplos de variáveis categóricas e seus níveis:</p>
<ul>
<li>Sexo: Masculino e Feminino.</li>
<li>Continente: Ásia, África, América do Norte, América do Sul, Antártica, Europa e Oceania.</li>
<li>Mês: Janeiro, Fevereiro, Março, Abril, Maio, Junho, etc.</li>
</ul>
<p>Para criar um fator podemos utlizar a função <code>factor()</code>. Vamos utilizar um vetor sexo que armazena a informação do sexo de 7 indivíduos e depois transformar sexo em um fator.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>sexo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Masculino"</span>, <span class="st">"Feminino"</span>, <span class="st">"Feminino"</span>, <span class="st">"Feminino"</span>, <span class="st">"Masculino"</span>, <span class="st">"Feminino"</span>, <span class="st">"Masculino"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>sexo</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="table-responsive">
<table class="table">
<colgroup>
<col style="width: 4%">
<col style="width: 16%">
<col style="width: 14%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 17%">
<col style="width: 14%">
</colgroup>
<tbody>
<tr class="odd">
<td>[1]</td>
<td>“Masculino”</td>
<td>“Feminino”</td>
<td>“Feminino”</td>
<td>“Feminino”</td>
<td>“Masculino”</td>
<td>“Feminino”</td>
</tr>
<tr class="even">
<td>[7]</td>
<td>“Masculino”</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fator_sexo <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sexo)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>fator_sexo</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="table-responsive">
<table class="table">
<colgroup>
<col style="width: 3%">
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 15%">
<col style="width: 13%">
<col style="width: 12%">
</colgroup>
<tbody>
<tr class="odd">
<td>[1]</td>
<td>Masculino</td>
<td>Feminino</td>
<td>Feminino</td>
<td>Feminino</td>
<td>Masculino</td>
<td>Feminino</td>
<td>Masculino</td>
</tr>
<tr class="even">
<td>[7]</td>
<td>Levels:</td>
<td>Feminino</td>
<td>Masculino</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>Observe que ao chamar o objeto sexo e o fator_sexo eles se apresentam de maneiras diferentes. Enquanto o vetor sexo contém elementos formados por uma sequência de caracteres entre aspas, o fator_sexo é formado por níveis de um fator, os Levels, e não contém aspas.</p>
</section>
<section id="forcats" class="level3">
<h3 class="anchored" data-anchor-id="forcats"><code>forcats</code></h3>
<p>O pacote <code>forcats</code> fornece um conjunto de ferramentas que nos ajudam a trabalhar com variáveis categóricas. Suas principais funções são: <code>fct_recode()</code>, <code>fct_colapse()</code>, <code>fct_reorder()</code>, <code>fct_lump()</code> e <code>lvls_reorder()</code>. Para quem não tem o pacote instalado, basta rodar os códigos a seguir.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"forcats"</span>) <span class="do">## instalando o pacote forcats</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats) <span class="do">## carregando o pacote forcats</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Além do <code>forcats</code> vamos precisar do <code>dplyr</code> e do <code>ggplot2</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="do">## carregando o pacote dplyr</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="do">## carregando o pacote ggplot2</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Para exemplificar as funções principais, vamos usar um conjunto de dados chamado <code>gss_cat</code> que faz parte do pacote <code>forcats</code>, para usar estes dados basta apenas digitar o nome no console.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(gss_cat) <span class="do">## Vizualizando o inicio dos dados</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="a-tibble-6-x-9" class="level4">
<h4 class="anchored" data-anchor-id="a-tibble-6-x-9">A tibble: 6 x 9</h4>
<div class="table-responsive">
<table class="table">
<colgroup>
<col style="width: 1%">
<col style="width: 7%">
<col style="width: 14%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 14%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>year</th>
<th>marital</th>
<th>age</th>
<th>race</th>
<th>rincome</th>
<th>partyid</th>
<th>relig</th>
<th>denom</th>
<th>tvhours</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td><int></int></td>
<td><fct></fct></td>
<td><int></int></td>
<td><fct></fct></td>
<td><fct></fct></td>
<td><fct></fct></td>
<td><fct></fct></td>
<td><fct></fct></td>
<td><int></int></td>
</tr>
<tr class="even">
<td>1</td>
<td>2000</td>
<td>Never mar…</td>
<td>26</td>
<td>White</td>
<td>$8000 to …</td>
<td>Ind,near r…</td>
<td>Protesta…</td>
<td>Souther…</td>
<td>12</td>
</tr>
<tr class="odd">
<td>2</td>
<td>2000</td>
<td>Divorced</td>
<td>48</td>
<td>White</td>
<td>$8000 to …</td>
<td>Not str re…</td>
<td>Protesta…</td>
<td>Baptist…</td>
<td>NA</td>
</tr>
<tr class="even">
<td>3</td>
<td>2000</td>
<td>Widowed</td>
<td>67</td>
<td>White</td>
<td>Not appli…</td>
<td>Independent</td>
<td>Protesta…</td>
<td>No deno…</td>
<td>2</td>
</tr>
<tr class="odd">
<td>4</td>
<td>2000</td>
<td>Never mar…</td>
<td>39</td>
<td>White</td>
<td>Not appli…</td>
<td>Ind,near r…</td>
<td>Orthodox…</td>
<td>Not app…</td>
<td>4</td>
</tr>
<tr class="even">
<td>5</td>
<td>2000</td>
<td>Divorced</td>
<td>25</td>
<td>White</td>
<td>Not appli…</td>
<td>Not str de…</td>
<td>None</td>
<td>Not app…</td>
<td>1</td>
</tr>
<tr class="odd">
<td>6</td>
<td>2000</td>
<td>Married</td>
<td>25</td>
<td>White</td>
<td>$20000 - …</td>
<td>Strong dem…</td>
<td>Protesta…</td>
<td>Souther…</td>
<td>NA</td>
</tr>
</tbody>
</table>
</div>
<p><code>gss_cat</code> é uma amostra de dados do <em>General Social Survey</em> <a href="http://gss.norc.org" class="uri">http://gss.norc.org</a>, que é uma pesquisa norte-americana e contém uma série de informações sobre as pessoas participantes, como o estado civil, idade, raça, renda, partido político, religião, denominação religiosa e a quantidade de horas que usam a TV por dia.</p>
</section>
<section id="fct_recode" class="level4">
<h4 class="anchored" data-anchor-id="fct_recode"><code>fct_recode()</code></h4>
<p>A primeira função que veremos é a <code>fct_recode()</code>. Ela tem como objetivo alterar categorias específicas de um fator. Para exemplificar esta função vamos usar a variável <code>marital</code> de <code>gss_cat</code>, esta variável contem os níveis (<em>No answer</em>, <em>Never married</em>, <em>Separated</em>, <em>Divorced</em>, <em>Widowed</em>, <em>Married</em>) das pessoas que participaram da pesquisa.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(gss_cat<span class="sc">$</span>marital)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="table-responsive">
<table class="table">
<colgroup>
<col style="width: 7%">
<col style="width: 60%">
<col style="width: 9%">
<col style="width: 23%">
</colgroup>
<tbody>
<tr class="odd">
<td>[1]</td>
<td>Never married Divorced</td>
<td>Widowed</td>
<td>Never married Divorced</td>
</tr>
<tr class="even">
<td>[6]</td>
<td>Married</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Levels:</td>
<td>No answer Never married Separated Divorced Widowed Married</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>Os argumentos da função funcionam da seguinte forma:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fct_recode</span>(nome_do_fator,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    nível<span class="at">_que_queremos =</span> <span class="st">"nível_que_vamos_alterar"</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    nível<span class="at">_que_queremos =</span> <span class="st">"nível_que_vamos_alterar"</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    nível<span class="at">_que_queremos =</span> <span class="st">"nível_que_vamos_alterar"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Queremos alterar todos os níveis exceto o <em>No answer</em>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>estado_civil <span class="ot">&lt;-</span> <span class="fu">fct_recode</span>(gss_cat<span class="sc">$</span>marital,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">Solteiro =</span> <span class="st">"Never married"</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Separado =</span> <span class="st">"Separated"</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Divorciado =</span> <span class="st">"Divorced"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    Viúvo <span class="ot">=</span> <span class="st">"Widowed"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Casado =</span> <span class="st">"Married"</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(estado_civil)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="table-responsive">
<table class="table">
<colgroup>
<col style="width: 8%">
<col style="width: 40%">
<col style="width: 20%">
<col style="width: 10%">
<col style="width: 19%">
</colgroup>
<tbody>
<tr class="odd">
<td>[1]</td>
<td>Solteiro</td>
<td>Divorciado Viúvo</td>
<td>Solteiro</td>
<td>Divorciado Casado</td>
</tr>
<tr class="even">
<td>Levels:</td>
<td>No answer Solteiro Separado Divorciado Viúvo Casado</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>Os níveis que não são mencionados em <code>fct_recode()</code> permanecem do mesmo jeito que estavam.</p>
</section>
<section id="fct_collapse" class="level4">
<h4 class="anchored" data-anchor-id="fct_collapse"><code>fct_collapse()</code></h4>
<p>Outra função importante do <code>forcats</code> é a <code>fct_collapse()</code>. Esta função junta manualmente os níveis em categorias definidas. Usaremos novamente os dados <code>gss_cat</code> e a variável <code>marital</code>. Queremos criar dois grupos de estado civil, solteiro e casado. A <code>fct_collapse()</code> segue a mesma estrutura de argumentos que a <code>fct_recode()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>estado_civil2 <span class="ot">&lt;-</span> <span class="fu">fct_collapse</span>(gss_cat<span class="sc">$</span>marital,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">solteiro =</span> (<span class="fu">c</span>(<span class="st">"Never married"</span>, <span class="st">"Divorced"</span>, <span class="st">"Widowed"</span>, <span class="st">"Separated"</span>)),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">casado =</span> (<span class="st">"Married"</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(estado_civil2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="table-responsive">
<table class="table">
<colgroup>
<col style="width: 10%">
<col style="width: 38%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<tbody>
<tr class="odd">
<td>[1]</td>
<td>solteiro</td>
<td>solteiro</td>
<td>solteiro</td>
<td>solteiro</td>
<td>solteiro</td>
</tr>
<tr class="even">
<td>Levels:</td>
<td>No answer solteiro casado</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>Como o nível <em>No answer</em> não foi incluído na função, ele não sofreu alteração alguma.</p>
</section>
<section id="fct_reorder" class="level4">
<h4 class="anchored" data-anchor-id="fct_reorder"><code>fct_reorder()</code></h4>
<p>A função <code>fct_reorder()</code> tem como principal objetivo reordenar a ordem dos níveis de fator. Vamos supor que queremos saber qual é o número médio de horas por dia que as pessoas passam diante da TV de acordo com cada religião. Para vizualizar esta idéia vamos criar uma tabela com todas as informações necessárias.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>relig <span class="ot">&lt;-</span> gss_cat <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(relig) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">tvhours =</span> <span class="fu">mean</span>(tvhours, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(relig)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="a-tibble-6-x-3" class="level4">
<h4 class="anchored" data-anchor-id="a-tibble-6-x-3">A tibble: 6 x 3</h4>
<div class="table-responsive">
<table class="table">
<thead>
<tr class="header">
<th></th>
<th>relig</th>
<th>tvhours</th>
<th>n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td><fct></fct></td>
<td><dbl></dbl></td>
<td><int></int></td>
</tr>
<tr class="even">
<td>1</td>
<td>No answer</td>
<td>2.72</td>
<td>93</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Don’t know</td>
<td>4.62</td>
<td>15</td>
</tr>
<tr class="even">
<td>3</td>
<td>Inter-nondenominational</td>
<td>2.87</td>
<td>109</td>
</tr>
<tr class="odd">
<td>4</td>
<td>Native american</td>
<td>3.46</td>
<td>23</td>
</tr>
<tr class="even">
<td>5</td>
<td>Christian</td>
<td>2.79</td>
<td>689</td>
</tr>
<tr class="odd">
<td>6</td>
<td>Orthodox-christian</td>
<td>2.42</td>
<td>95</td>
</tr>
</tbody>
</table>
</div>
<p>As funções <code>group_by()</code>e <code>summarize()</code> fazem parte do pacote <code>dplyr</code>. Para quem não conhece é só dar uma olhada neste <a href="https://daslab-ufes.github.io/dplyr/">post</a>.</p>
<p>Criamos a variável <code>relig</code> com as informações das religões, das idades e da média de horas gastas por dia diante da TV. Olhando apenas a tabela acima não é possível concluir muita coisa, para uma melhor vizualização vamos criar um gráfico com o <code>ggplot2</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(relig, <span class="fu">aes</span>(tvhours, relig)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<!-- FALTANDO IMAGEM -->
<!-- <center>
![](/assets/files/post_github/image1.png)
</center> -->
<p>Note que as informações no gráfico ficaram todas espalhadas e desordenadas, para resolver isso vamos usar a função <code>fct_reorder()</code>. Ela pode receber três argumentos:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fct_reorder</span>(<span class="at">f =</span> <span class="st">"argumento 1"</span>, <span class="at">x =</span> <span class="st">"argumento 2"</span>, <span class="at">fun =</span> <span class="st">"argumento 3"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>O primeiro argumento, <strong>f</strong>, é o fator cujo níveis queremos modificar. O segundo argumento, <strong>x</strong>, é um vetor numérico que queremos usar para reordenar os níveis. O terceiro argumento, <strong>fun</strong>, é uma função que é usada se houver múltiplos valores de x para cada valor de <strong>f</strong>. No nosso exemplo o argumento <strong>f</strong> é a nossa tabela <code>relig</code> e o nosso argumento <strong>x</strong> é a variável <code>tvhours</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(relig, <span class="fu">aes</span>(tvhours, <span class="fu">fct_reorder</span>(relig, tvhours))) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<!-- FALTANDO IMAGEM -->
<!-- <center>
![](/assets/files/post_github/image2.png)
</center> -->
<p>Observando o gráfico ordenado podemos concluir que as pessoas que seguem o Hinduímos e outras religiões orientais passam menos horas em frente a TV do que as pessoas nativo americanas e protestantes.</p>
</section>
<section id="fct_lump" class="level4">
<h4 class="anchored" data-anchor-id="fct_lump"><code>fct_lump()</code></h4>
<p>Esta função ajuda a agrupar as categorias menores em apenas um grupo denominado <strong>other</strong>. Para este exemplo vamos utilizar a variável relig novamente.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>gss_cat <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(relig, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="do">## Conta a quantidade de observações em cada categoria em ordem decresecente</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="a-tibble-15-x-2" class="level4">
<h4 class="anchored" data-anchor-id="a-tibble-15-x-2">A tibble: 15 x 2</h4>
<div class="table-responsive">
<table class="table">
<thead>
<tr class="header">
<th></th>
<th>relig</th>
<th>n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td><fct></fct></td>
<td><int></int></td>
</tr>
<tr class="even">
<td>1</td>
<td>Protestant</td>
<td>10846</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Catholic</td>
<td>5124</td>
</tr>
<tr class="even">
<td>3</td>
<td>None</td>
<td>3523</td>
</tr>
<tr class="odd">
<td>4</td>
<td>Christian</td>
<td>689</td>
</tr>
<tr class="even">
<td>5</td>
<td>Jewish</td>
<td>388</td>
</tr>
<tr class="odd">
<td>6</td>
<td>Other</td>
<td>224</td>
</tr>
<tr class="even">
<td>7</td>
<td>Buddhism</td>
<td>147</td>
</tr>
<tr class="odd">
<td>8</td>
<td>Inter-nondenominational</td>
<td>109</td>
</tr>
<tr class="even">
<td>9</td>
<td>Moslem/islam</td>
<td>104</td>
</tr>
<tr class="odd">
<td>10</td>
<td>Orthodox-christian</td>
<td>95</td>
</tr>
<tr class="even">
<td>11</td>
<td>No answer</td>
<td>93</td>
</tr>
<tr class="odd">
<td>12</td>
<td>Hinduism</td>
<td>71</td>
</tr>
<tr class="even">
<td>13</td>
<td>Other eastern</td>
<td>32</td>
</tr>
<tr class="odd">
<td>14</td>
<td>Native american</td>
<td>23</td>
</tr>
<tr class="even">
<td>15</td>
<td>Don’t know</td>
<td>15</td>
</tr>
</tbody>
</table>
</div>
<p>Na variável <code>relig</code>, a religião que possui um maior número de pessoas é a Protestante, ao aplicar a função <code>fct_lump</code> todas as outras religiões menores serão agrupadas em apenas uma.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>gss_cat <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">relig =</span> <span class="fu">fct_lump</span>(relig)) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(relig)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="a-tibble-2-x-2" class="level4">
<h4 class="anchored" data-anchor-id="a-tibble-2-x-2">A tibble: 2 x 2</h4>
<div class="table-responsive">
<table class="table">
<thead>
<tr class="header">
<th></th>
<th>relig</th>
<th>n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td><fct></fct></td>
<td><int></int></td>
</tr>
<tr class="even">
<td>1</td>
<td>Protestant</td>
<td>10846</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Other</td>
<td>10637</td>
</tr>
</tbody>
</table>
</div>
<p>Apesar dos americanos participantes da pesquisa serem em grande número protestantes, nós deixamos outras religiões com quantidades significativas de fora. Para especificar melhor quais as observações queremos agrupar, vamos usar um argumento <strong>n</strong> dentro da função <code>fct_lump()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>gss_cat <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">relig =</span> <span class="fu">fct_lump</span>(relig, <span class="at">n =</span> <span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(relig, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="a-tibble-6-x-2" class="level4">
<h4 class="anchored" data-anchor-id="a-tibble-6-x-2">A tibble: 6 x 2</h4>
<div class="table-responsive">
<table class="table">
<thead>
<tr class="header">
<th></th>
<th>relig</th>
<th>n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td><fct></fct></td>
<td><int></int></td>
</tr>
<tr class="even">
<td>1</td>
<td>Protestant</td>
<td>10846</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Catholic</td>
<td>5124</td>
</tr>
<tr class="even">
<td>3</td>
<td>None</td>
<td>3523</td>
</tr>
<tr class="odd">
<td>4</td>
<td>Other</td>
<td>913</td>
</tr>
<tr class="even">
<td>5</td>
<td>Christian</td>
<td>689</td>
</tr>
<tr class="odd">
<td>6</td>
<td>Jewish</td>
<td>388</td>
</tr>
</tbody>
</table>
</div>
<p>Usamos o argumento <strong>n</strong> para especificar quantos grupos queremos manter fora do agrupamento. Assim podemos ver que os católicos, os cristãos e os judeus também estão em número expressivo na pesquisa.</p>
<p>Dentro de <code>fct_lump()</code> temos quatro funções: <code>fct_lump_min()</code>, <code>fct_lump_prop()</code>, <code>fct_lump_n()</code> e <code>fct_lump_lowfreq()</code>.</p>
<ul>
<li><code>fct_lump_min():</code> agrupa os níveis de fator que aparecem com menor frequência do que uma quantidade determinada de vezes.</li>
<li><code>fct_lump_n():</code> agrupa todos os níveis, exceto os <strong>n</strong> níveis mais frequentes.</li>
<li><code>fct_lump_prop():</code> agrupa os níveis que aparecem em menos proporção.</li>
<li><code>fct_lump_lowfreq():</code> agrupa os níveis menos frequentes.</li>
</ul>
<p><a href="https://forcats.tidyverse.org/reference/fct_lump.html">Aqui</a> há algumas aplicações destas funções.</p>
</section>
<section id="lvls_reorder" class="level4">
<h4 class="anchored" data-anchor-id="lvls_reorder"><code>lvls_reorder()</code></h4>
<p>Esta função tem como objetivo modificar a ordem dos níveis de um fator. Para exemplificar, vamos utilizar a variável <code>marital</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fator <span class="ot">&lt;-</span> <span class="fu">head</span>(gss_cat<span class="sc">$</span>marital)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>fator</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="table-responsive">
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 55%">
<col style="width: 16%">
<col style="width: 21%">
</colgroup>
<tbody>
<tr class="odd">
<td>[1]</td>
<td>Never married Divorced</td>
<td>Widowed</td>
<td>Never married Divorced</td>
</tr>
<tr class="even">
<td>[6]</td>
<td>Married</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Levels:</td>
<td>No answer Never married Separated Divorced Widowed Married</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>Note que os níveis estão ordenados assim: <em>No answer</em>, <em>Never married</em>, <em>Separated</em>, <em>Divorced</em>, <em>Widowed</em>, <em>Married</em>.</p>
<p>Para modificar a ordem basta imaginarmos que cada nível tem uma posição, um índice, e o que temos que fazer é reorganizar estas posições. Então ficaria assim:</p>
<p>Os níveis estão ordenados: <em>No answer</em>(1), <em>Never married</em>(2), <em>Separated</em>(3), <em>Divorced</em>(4), <em>Widowed</em>(5), <em>Married</em>(6).</p>
<p>Queremos que seja: <em>Divorced</em>(4), <em>Married</em>(6), <em>Never married</em>(2), <em>No answer</em>(1), <em>Separated</em>(3), <em>Widowed</em>(5).</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lvls_reorder</span>(fator, <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="table-responsive">
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 55%">
<col style="width: 16%">
<col style="width: 21%">
</colgroup>
<tbody>
<tr class="odd">
<td>[1]</td>
<td>Never married Divorced</td>
<td>Widowed</td>
<td>Never married Divorced</td>
</tr>
<tr class="even">
<td>[6]</td>
<td>Married</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Levels:</td>
<td>Divorced Married Never married No answer Separated Widowed</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>Além destas funções apresentadas até agora, o <code>forcats</code> possui outras funções bastante úteis. Para exemplificar algumas vamos criar um fator com letras e fazer alguns testes.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fator <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"d"</span>, <span class="st">"c"</span>, <span class="st">"a"</span>, <span class="st">"d"</span>, <span class="st">"d"</span>, <span class="st">"d"</span>, <span class="st">"c"</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>fator</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="table-responsive">
<table class="table">
<tbody>
<tr class="odd">
<td>[1]</td>
<td>b</td>
<td>b</td>
<td>d</td>
<td>c</td>
<td>a</td>
<td>d</td>
<td>d</td>
<td>d</td>
<td>c</td>
</tr>
<tr class="even">
<td>Levels:</td>
<td>a</td>
<td>b</td>
<td>c</td>
<td>d</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>A primeira função é a <code>fct_relevel()</code>, com ela é possível ordenar os níveis manualmente. Observe que os níveis sempre são ordenados automaticamente em ordem alfabética, para controlar isso é só escrever a ordem desejada no segundo argumento da função.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fct_relevel</span>(fator, <span class="fu">c</span>(<span class="st">"d"</span>, <span class="st">"a"</span>, <span class="st">"c"</span>, <span class="st">"b"</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="table-responsive">
<table class="table">
<tbody>
<tr class="odd">
<td>[1]</td>
<td>b</td>
<td>b</td>
<td>d</td>
<td>c</td>
<td>a</td>
<td>d</td>
<td>d</td>
<td>d</td>
<td>c</td>
</tr>
<tr class="even">
<td>Levels:</td>
<td>d</td>
<td>a</td>
<td>c</td>
<td>b</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>Esta função é similiar a <code>lvls_reorder()</code>, a diferença é que a <code>fct_relevel()</code>considera os níveis de fator para reordenar enquanto na <code>lvls_reorder()</code> utilizamos os índices (1, 2,…) dos níveis.</p>
<p>Uma outra função que vale a pena ser comentada é a <code>fct_infreq()</code>. Ela tem como objetivo organizar os níveis de um fator por sua frequência.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fct_infreq</span>(fator)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="table-responsive">
<table class="table">
<tbody>
<tr class="odd">
<td>[1]</td>
<td>b</td>
<td>b</td>
<td>d</td>
<td>c</td>
<td>a</td>
<td>d</td>
<td>d</td>
<td>d</td>
<td>c</td>
</tr>
<tr class="even">
<td>Levels:</td>
<td>d</td>
<td>b</td>
<td>c</td>
<td>a</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>Note que agora as ordens dos níveis são: d, b, c, a. A mudança foi feita pois no nosso fator ‘fator’ há quatro vezes a letra ‘d’, duas vezes a letra ‘b’, duas vezes a letra ‘c’ e apenas uma vez a letra ‘a’.</p>
<p>Falando ainda em frequências, temos a função <code>fct_count()</code>, ela cria uma tabela de frequências dos níveis de um fator.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fct_count</span>(fator)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="a-tibble-4-x-2" class="level4">
<h4 class="anchored" data-anchor-id="a-tibble-4-x-2">A tibble: 4 x 2</h4>
<div class="table-responsive">
<table class="table">
<thead>
<tr class="header">
<th></th>
<th>f</th>
<th>n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td><fct></fct></td>
<td><int></int></td>
</tr>
<tr class="even">
<td>1</td>
<td>a</td>
<td>1</td>
</tr>
<tr class="odd">
<td>2</td>
<td>b</td>
<td>2</td>
</tr>
<tr class="even">
<td>3</td>
<td>c</td>
<td>2</td>
</tr>
<tr class="odd">
<td>4</td>
<td>d</td>
<td>4</td>
</tr>
</tbody>
</table>
</div>
<p>Neste exemplo, a letra ‘f’ representa os níveis (a, b, c, d), e a letra ‘n’ representa a frequência em que cada nível aparece no fator.</p>
<p>Outra função interessante é a <code>fct_unique()</code>, ela remove os níveis duplicados em um fator para que haja apenas um valor de cada nível.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fct_unique</span>(fator)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="table-responsive">
<table class="table">
<tbody>
<tr class="odd">
<td>[1]</td>
<td>a</td>
<td>b</td>
<td>c</td>
<td>d</td>
</tr>
<tr class="even">
<td>Levels:</td>
<td>a</td>
<td>b</td>
<td>c</td>
<td>d</td>
</tr>
</tbody>
</table>
</div>
<p>Repare que o R só printou um único valor de cada nível.</p>
<p>Agora vamos ver um exemplo da função <code>fct_c()</code>, ela combina dois fatores. Ja temos o fator ‘fator’, agora vamos criar o ‘fator2’.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>fator2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"g"</span>, <span class="st">"h"</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fct_c</span>(fator, fator2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="table-responsive">
<table class="table">
<tbody>
<tr class="odd">
<td>[1]</td>
<td>b</td>
<td>b</td>
<td>d</td>
<td>c</td>
<td>a</td>
<td>d</td>
<td>d</td>
<td>d</td>
<td>c</td>
<td>g</td>
<td>h</td>
</tr>
<tr class="even">
<td>Levels:</td>
<td>a</td>
<td>b</td>
<td>c</td>
<td>d</td>
<td>g</td>
<td>h</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>Veja que a função <code>fct_c()</code> juntou os dois fatores e deu origem ao novo fator com os níveis: a, b, c, d, g, h.</p>
<p>Estas foram algumas das funções que o <code>forcats</code> tem a nos oferecer. Se fosse possível acrescentaríamos muitas outras funções deste pacote, porém o post tem que acabar. Para saber mais sobre o assunto recomendo uma leitura nos links abaixo.</p>
</section>
</section>
<section id="referências" class="level3">
<h3 class="anchored" data-anchor-id="referências"><code>Referências</code></h3>
<p><a href="https://forcats.tidyverse.org/" class="uri">https://forcats.tidyverse.org/</a></p>
<p><a href="https://r4ds.had.co.nz/factors.html" class="uri">https://r4ds.had.co.nz/factors.html</a>.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p><br>Copyright © 2024 | Made by <a href="https://www.josecarlosinfo.com/"> Jose C. S. Junior</a> | Built with <a href="https://quarto.org/">Quarto</a></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>